/* Developer Task Manager – layout and theme */

:root {
    --color-text: #37352f;
    --color-text-muted: #787774;
    --color-text-placeholder: #9b9a97;
    --color-bg: #f7f6f3;
    --color-bg-card: #fff;
    --color-bg-card-hover: #f5f4f1;
    --color-border: rgba(55, 53, 47, 0.09);
    --color-border-strong: rgba(55, 53, 47, 0.12);
    --color-border-column: rgba(55, 53, 47, 0.2);
    --color-border-focus: rgba(55, 53, 47, 0.35);
    --color-scrollbar-track: rgba(55, 53, 47, 0.06);
    --color-scrollbar-thumb: rgba(55, 53, 47, 0.2);
    /* Task type colors */
    --color-type-coding: #2563eb;
    --color-type-coding-soft: rgba(37, 99, 235, 0.18);
    --color-type-debugging: #ea580c;
    --color-type-debugging-soft: rgba(234, 88, 12, 0.18);
    --color-type-learning: #059669;
    --color-type-learning-soft: rgba(5, 150, 105, 0.18);
    --color-primary: #37352f;
    --color-primary-hover: #2f2d29;
    --color-overdue: rgba(235, 87, 87, 0.7);
    --color-due-soon: rgba(245, 190, 80, 0.7);
    --color-shadow: rgba(0, 0, 0, 0.08);
    --color-shadow-strong: rgba(55, 53, 47, 0.12);
    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 0.75rem;
    --space-lg: 1rem;
    --space-xl: 1.25rem;
    --font-body: 0.9375rem;
    --font-sm: 0.8125rem;
    --font-xs: 0.75rem;
    --font-label: 0.75rem;
    --input-padding-y: 0.6rem;
    --input-padding-x: 0.875rem;
}

[data-theme="dark"] {
    --color-text: #e3e2e0;
    --color-text-muted: #9b9a97;
    --color-text-placeholder: #6f6e6b;
    --color-bg: #191919;
    --color-bg-card: #252525;
    --color-bg-card-hover: #2d2d2d;
    --color-border: rgba(255, 255, 255, 0.08);
    --color-border-strong: rgba(255, 255, 255, 0.12);
    --color-border-column: rgba(255, 255, 255, 0.22);
    --color-border-focus: rgba(255, 255, 255, 0.25);
    --color-scrollbar-track: rgba(255, 255, 255, 0.06);
    --color-scrollbar-thumb: rgba(255, 255, 255, 0.35);
    /* Task type colors – dark mode */
    --color-type-coding: #60a5fa;
    --color-type-coding-soft: rgba(96, 165, 250, 0.2);
    --color-type-debugging: #fb923c;
    --color-type-debugging-soft: rgba(251, 146, 60, 0.2);
    --color-type-learning: #34d399;
    --color-type-learning-soft: rgba(52, 211, 153, 0.2);
    --color-primary: #4a4a4a;
    --color-primary-hover: #5a5a5a;
    --color-overdue: rgba(235, 87, 87, 0.6);
    --color-due-soon: rgba(245, 190, 80, 0.6);
    --color-shadow: rgba(0, 0, 0, 0.3);
    --color-shadow-strong: rgba(0, 0, 0, 0.4);
}

* { box-sizing: border-box; }

html { transition: background-color 0.25s ease, color 0.25s ease; }

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", sans-serif;
    background: var(--color-bg);
    color: var(--color-text);
    min-height: 100vh;
    margin: 0;
    padding: 0;
    line-height: 1.5;
    font-size: var(--font-body);
    overflow: hidden;
    transition: background-color 0.25s ease, color 0.25s ease;
}

/* Scrollbar – uses CSS variables so dark theme gets darker thumb */
.column-left,
.column-main,
.column-right,
.task-panel {
    scrollbar-color: var(--color-scrollbar-thumb) var(--color-scrollbar-track);
    scrollbar-width: thin;
}
.column-left::-webkit-scrollbar,
.column-main::-webkit-scrollbar,
.column-right::-webkit-scrollbar,
.task-panel::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}
.column-left::-webkit-scrollbar-track,
.column-main::-webkit-scrollbar-track,
.column-right::-webkit-scrollbar-track,
.task-panel::-webkit-scrollbar-track {
    background: var(--color-scrollbar-track);
}
.column-left::-webkit-scrollbar-thumb,
.column-main::-webkit-scrollbar-thumb,
.column-right::-webkit-scrollbar-thumb,
.task-panel::-webkit-scrollbar-thumb {
    background: var(--color-scrollbar-thumb);
    border-radius: 6px;
    border: 3px solid transparent;
    background-clip: padding-box;
}
.column-left::-webkit-scrollbar-thumb:hover,
.column-main::-webkit-scrollbar-thumb:hover,
.column-right::-webkit-scrollbar-thumb:hover,
.task-panel::-webkit-scrollbar-thumb:hover {
    background: var(--color-border-strong);
    background-clip: padding-box;
}

.app-layout,
.column-left,
.column-main,
.column-right,
.app-header,
.card,
.widget,
.task-panel,
.panel-overlay,
.add-form input,
.add-form textarea,
.add-form select,
.pomodoro-box {
    transition: background-color 0.25s ease, color 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
}

/* Layout */
.app-layout {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}

.app-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-md) var(--space-lg);
    background: var(--color-bg-card);
    border-bottom: 1px solid var(--color-border);
    flex-shrink: 0;
}

.app-header-title {
    font-weight: 600;
    font-size: 1.125rem;
    color: var(--color-text);
}

.app-columns {
    display: flex;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

.column-left {
    width: 280px;
    flex-shrink: 0;
    background: var(--color-bg);
    border-right: 2px solid var(--color-border-column);
    overflow-y: auto;
}

.column-left-inner {
    padding: var(--space-lg);
}

.app-title { font-size: 1.25rem; margin: 0 0 var(--space-xs) 0; color: var(--color-text); }
.app-subtitle { font-size: var(--font-sm); color: var(--color-text-muted); margin: 0 0 var(--space-lg) 0; }

.add-task-heading {
    font-size: var(--font-label);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--color-text-muted);
    margin: 0 0 var(--space-md) 0;
}

.add-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
    margin: 0;
    padding: 0;
}

.add-form input[type="text"],
.add-form textarea,
.add-form input[type="date"],
.add-form select {
    width: 100%;
    padding: var(--input-padding-y) var(--input-padding-x);
    font-size: var(--font-body);
    font-family: inherit;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    color: var(--color-text);
}

.add-form textarea { resize: vertical; min-height: 2.75rem; }
.add-form input::placeholder,
.add-form textarea::placeholder { color: var(--color-text-placeholder); }
.add-form input:focus,
.add-form textarea:focus,
.add-form select:focus {
    outline: none;
    border-color: var(--color-border-focus);
}

.form-row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-md);
    align-items: flex-end;
}

.form-row label { display: flex; flex-direction: column; gap: var(--space-xs); }
.label-text { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); }
.add-form-date { min-width: 140px; }

/* Type picker (custom dropdown with color swatch) */
.type-picker { position: relative; display: flex; flex-direction: column; gap: var(--space-xs); min-width: 140px; }
.type-picker .label-text { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); }
.type-picker-btn {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    width: 100%;
    min-width: 0;
    min-height: 2.5rem;
    padding: var(--input-padding-y) var(--input-padding-x);
    box-sizing: border-box;
    font-size: var(--font-body);
    font-family: inherit;
    text-align: left;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    color: var(--color-text);
    cursor: pointer;
}
.type-picker-btn:hover { border-color: var(--color-border-focus); }
.type-picker-btn::after { content: "▾"; margin-left: auto; font-size: 0.75em; color: var(--color-text-muted); }
.type-picker.open .type-picker-btn { border-color: var(--color-border-focus); }
.type-swatch {
    width: 14px;
    height: 14px;
    border-radius: 3px;
    flex-shrink: 0;
}
.type-picker-dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    width: 100%;
    min-width: 140px;
    margin-top: 2px;
    padding: var(--space-xs);
    background: var(--color-bg-card);
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-sm);
    box-shadow: var(--color-shadow-strong);
    z-index: 10;
    max-height: 200px;
    overflow-y: auto;
    box-sizing: border-box;
}
.type-picker.open .type-picker-dropdown { display: block; }
.type-picker-option {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    min-height: 2.25rem;
    box-sizing: border-box;
    font-size: var(--font-body);
    color: var(--color-text);
    cursor: pointer;
    border-radius: var(--radius-sm);
    border: none;
    width: 100%;
    min-width: 0;
    text-align: left;
    background: transparent;
    font-family: inherit;
}
.type-picker-option:hover { background: var(--color-bg-card-hover); }
.type-picker-option[data-value="coding"] .type-swatch { background: var(--color-type-coding); }
.type-picker-option[data-value="debugging"] .type-swatch { background: var(--color-type-debugging); }
.type-picker-option[data-value="learning"] .type-swatch { background: var(--color-type-learning); }
/* Button swatch reflects selected type */
.type-picker-btn .type-swatch.type-swatch--coding { background: var(--color-type-coding); }
.type-picker-btn .type-swatch.type-swatch--debugging { background: var(--color-type-debugging); }
.type-picker-btn .type-swatch.type-swatch--learning { background: var(--color-type-learning); }

.add-form-code-link-wrap { display: flex; flex-direction: column; gap: var(--space-xs); }
.add-form-code-link-wrap .label-text { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); }

.add-form button {
    padding: var(--space-md) var(--space-xl);
    font-size: var(--font-body);
    font-weight: 500;
    font-family: inherit;
    background: var(--color-primary);
    color: #fff;
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
}
.add-form button:hover { background: var(--color-primary-hover); }

/* Theme toggle */
.theme-toggle {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: var(--space-sm);
    border-radius: var(--radius-sm);
    color: var(--color-text-muted);
}
.theme-toggle:hover { color: var(--color-text); background: var(--color-border); }
.theme-icon-dark { display: none; }
.theme-icon-light { display: inline; }
[data-theme="dark"] .theme-icon-dark { display: inline; }
[data-theme="dark"] .theme-icon-light { display: none; }

/* Main column */
.column-main {
    flex: 1;
    min-width: 0;
    min-height: 0;
    overflow-y: auto;
}

.column-main-inner {
    display: block;
    padding: var(--space-lg);
    min-height: min-content;
}

.column-main-inner .timeline-wrap,
.column-main-inner .board-search-wrap {
    flex-shrink: 0;
}

.column-main-inner .board {
    display: flex;
    gap: var(--space-lg);
    align-items: flex-start;
    min-height: 0;
}

.column-main-inner .empty {
    flex: 1;
}

.empty { color: var(--color-text-muted); margin: var(--space-lg) 0; }

/* Timeline */
.timeline-wrap { margin-bottom: var(--space-lg); }
.timeline-title { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); margin: 0 0 var(--space-sm) 0; }
.timeline { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: var(--space-xs); }
.timeline-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-sm) var(--space-md);
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    color: var(--color-text);
    text-decoration: none;
    font-size: var(--font-sm);
}
.timeline-item:hover { background: var(--color-bg-card-hover); }
.timeline-item-title { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.timeline-item-date { font-size: var(--font-xs); color: var(--color-text-muted); flex-shrink: 0; margin-left: var(--space-sm); }

/* Board search */
.board-search-wrap { margin-bottom: var(--space-md); }
.board-search {
    width: 100%;
    padding: var(--input-padding-y) var(--input-padding-x);
    font-size: var(--font-body);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    color: var(--color-text);
}
.board-search:focus { outline: none; border-color: var(--color-border-focus); }

/* Board & columns – fill middle column */
.board {
    display: flex;
    gap: var(--space-lg);
    align-items: stretch;
    flex: 1;
    min-height: 0;
}

.column {
    flex: 1;
    min-width: 180px;
    max-width: none;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-md);
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 12px var(--color-shadow);
}

/* Different colored shadows per column */
.column[data-status="todo"] {
    box-shadow: 0 4px 16px rgba(245, 190, 80, 0.25), 0 2px 6px var(--color-shadow);
}

.column[data-status="in progress"] {
    box-shadow: 0 4px 16px rgba(100, 150, 255, 0.25), 0 2px 6px var(--color-shadow);
}

.column[data-status="done"] {
    box-shadow: 0 4px 16px rgba(80, 200, 120, 0.25), 0 2px 6px var(--color-shadow);
}

[data-theme="dark"] .column[data-status="todo"] {
    box-shadow: 0 4px 16px rgba(245, 190, 80, 0.2), 0 2px 6px var(--color-shadow);
}

[data-theme="dark"] .column[data-status="in progress"] {
    box-shadow: 0 4px 16px rgba(100, 150, 255, 0.2), 0 2px 6px var(--color-shadow);
}

[data-theme="dark"] .column[data-status="done"] {
    box-shadow: 0 4px 16px rgba(80, 200, 120, 0.2), 0 2px 6px var(--color-shadow);
}

.column-header {
    font-size: var(--font-label);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: var(--color-text-muted);
    margin: 0 0 var(--space-md) 0;
    padding-bottom: var(--space-sm);
    border-bottom: 1px solid var(--color-border);
    flex-shrink: 0;
}

.column-cards {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
    box-shadow: 0 1px 2px var(--color-shadow);
}
.card:hover { background: var(--color-bg-card-hover); }
.card-search-hidden { display: none !important; }
.card.drag-over { opacity: 0.6; }
.column.drag-over { background: var(--color-bg-card-hover); }

/* Task type card accent (left border) */
.card.card--coding { border-left: 4px solid var(--color-type-coding); }
.card.card--debugging { border-left: 4px solid var(--color-type-debugging); }
.card.card--learning { border-left: 4px solid var(--color-type-learning); }

.card-body-header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md);
    cursor: pointer;
}
.card-collapse-toggle {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    padding: 0;
    font-size: 1rem;
    line-height: 1;
    background: transparent;
    border: none;
    color: var(--color-text-muted);
    cursor: pointer;
    border-radius: var(--radius-sm);
}
.card-collapse-toggle:hover { color: var(--color-text); background: var(--color-border); }
.card--collapsed .card-body-detail { display: none; }
.card--collapsed .card-collapse-toggle { transform: rotate(-90deg); }

.task-title { font-weight: 500; flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

.card-body-detail { padding: 0 var(--space-md) var(--space-md); }
.task-description { font-size: var(--font-sm); color: var(--color-text-muted); margin: 0 0 var(--space-sm) 0; line-height: 1.5; }

.task-meta-row {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    flex-wrap: wrap;
    font-size: var(--font-xs);
}
.badge { padding: 2px 6px; border-radius: var(--radius-sm); font-weight: 500; }
.badge-type { background: var(--color-border); color: var(--color-text-muted); }
.badge-type--coding { background: var(--color-type-coding-soft); color: var(--color-type-coding); }
.badge-type--debugging { background: var(--color-type-debugging-soft); color: var(--color-type-debugging); }
.badge-type--learning { background: var(--color-type-learning-soft); color: var(--color-type-learning); }
.task-due-date { color: var(--color-text-muted); }
.task-overdue .task-due-date { color: var(--color-overdue); }
.task-due-soon .task-due-date { color: var(--color-due-soon); }

.task-code-link {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    max-width: 100%;
    font-size: var(--font-xs);
    color: var(--color-text-muted);
    text-decoration: none;
    border-radius: var(--radius-sm);
    padding: 1px 4px;
    margin-left: auto;
}
.task-code-link:hover { color: var(--color-text); background: var(--color-border); }
.task-code-link-text { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 140px; }

.task-progress {
    margin-top: var(--space-sm);
    font-size: var(--font-xs);
    color: var(--color-text-muted);
    position: relative;
    height: 20px;
    background: var(--color-border);
    border-radius: var(--radius-sm);
    overflow: hidden;
}
.task-progress-bar { position: absolute; left: 0; top: 0; bottom: 0; background: var(--color-primary); border-radius: var(--radius-sm); transition: width 0.2s ease; }
.task-progress-text { position: relative; z-index: 1; padding: 0 var(--space-sm); line-height: 20px; display: block; }

.task-subtasks { margin-top: var(--space-sm); }
.subtask-list { list-style: none; margin: 0 0 var(--space-sm) 0; padding: 0; }
.subtask-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xs) 0;
    font-size: var(--font-sm);
}
.subtask-item.subtask-done .subtask-title { text-decoration: line-through; color: var(--color-text-muted); }
.subtask-checkbox {
    width: 20px;
    height: 20px;
    padding: 0;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    cursor: pointer;
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    justify-content: center;
}
.subtask-checkbox:hover { border-color: var(--color-border-focus); }
.subtask-title { flex: 1; min-width: 0; }
.subtask-delete { background: transparent; border: none; color: var(--color-text-muted); cursor: pointer; padding: 0 4px; font-size: 1rem; }
.subtask-delete:hover { color: var(--color-text); }
.subtask-add-form { display: flex; gap: var(--space-sm); margin: 0; }
.subtask-add-form input { flex: 1; padding: var(--space-xs) var(--space-sm); font-size: var(--font-sm); border: 1px solid var(--color-border); border-radius: var(--radius-sm); background: var(--color-bg); color: var(--color-text); }
.subtask-add-btn { padding: var(--space-xs) var(--space-sm); font-size: var(--font-xs); background: var(--color-border); border: none; border-radius: var(--radius-sm); cursor: pointer; color: var(--color-text); }

.card-actions {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    border-top: 1px solid var(--color-border);
    background: var(--color-bg);
}
.status-form { margin: 0; }
.status-form select {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--font-xs);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    color: var(--color-text);
    cursor: pointer;
}
.delete-form { margin: 0; margin-left: auto; }
.delete-btn { background: transparent; border: none; color: var(--color-text-muted); cursor: pointer; padding: 0 4px; font-size: 1.25rem; }
.delete-btn:hover { color: var(--color-text); }

/* Right column – widgets */
.column-right {
    width: 300px;
    flex-shrink: 0;
    background: var(--color-bg);
    border-left: 2px solid var(--color-border-column);
    overflow-y: auto;
}

.column-right-inner {
    padding: var(--space-lg);
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

.widget {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
}
.widget:first-child { margin-top: 0; }

/* Quote widget */
.widget-quote { flex-shrink: 0; }
.quote-widget-header { font-size: var(--font-label); font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; color: var(--color-text-muted); padding: var(--space-md) var(--space-lg); border-bottom: 1px solid var(--color-border); }
.quote-widget-body { padding: var(--space-lg); }
.quote-text { font-size: var(--font-body); line-height: 1.5; color: var(--color-text); margin: 0 0 var(--space-sm) 0; font-style: italic; border: none; }
.quote-author { font-size: var(--font-sm); color: var(--color-text-muted); font-style: normal; display: block; }

/* Pet widget */
.widget-pet { flex-shrink: 0; }
.pet-widget-header { font-size: var(--font-label); font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; color: var(--color-text-muted); padding: var(--space-md) var(--space-lg); border-bottom: 1px solid var(--color-border); }
.pet-widget-body { padding: var(--space-lg); display: flex; justify-content: center; align-items: center; min-height: 100px; }
.pet-container { position: relative; cursor: pointer; user-select: none; touch-action: manipulation; }
.pet-character { display: inline-flex; align-items: center; justify-content: center; font-size: 2.5rem; line-height: 1; animation: pet-idle 2.5s ease-in-out infinite; }
.pet-face { display: inline-block; filter: drop-shadow(0 2px 4px var(--color-shadow)); }
.pet-container:hover .pet-character { animation: pet-idle 1.5s ease-in-out infinite; }
.pet-container.pet--wave .pet-character { animation: pet-wave 0.6s ease-in-out; }
.pet-container.pet--bounce .pet-character { animation: pet-bounce 0.5s ease-out; }
.pet-container.pet--happy .pet-character { animation: pet-happy 1.2s ease-in-out; }
@keyframes pet-idle { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
@keyframes pet-wave { 0% { transform: translateY(0) rotate(0deg); } 25% { transform: translateY(-6px) rotate(-12deg); } 50% { transform: translateY(-8px) rotate(8deg); } 75% { transform: translateY(-4px) rotate(-6deg); } 100% { transform: translateY(0) rotate(0deg); } }
@keyframes pet-bounce { 0% { transform: translateY(0) scale(1); } 40% { transform: translateY(-14px) scale(1.08); } 70% { transform: translateY(-4px) scale(1.02); } 100% { transform: translateY(0) scale(1); } }
@keyframes pet-happy { 0% { transform: translateY(0) scale(1); } 20% { transform: translateY(-12px) scale(1.15); } 40% { transform: translateY(-4px) scale(1.1); } 60% { transform: translateY(-10px) scale(1.12); } 80% { transform: translateY(-2px) scale(1.05); } 100% { transform: translateY(0) scale(1); } }
.pet-message {
    position: absolute;
    left: 50%;
    bottom: 100%;
    transform: translateX(-50%) translateY(-8px);
    padding: var(--space-sm) var(--space-md);
    font-size: var(--font-xs);
    color: var(--color-text);
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--color-shadow-strong);
    white-space: nowrap;
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease;
}
.pet-message::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -6px; border: 6px solid transparent; border-top-color: var(--color-border); }
.pet-message::before { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; margin-top: -1px; border: 5px solid transparent; border-top-color: var(--color-bg-card); }
.pet-message.pet-message--visible { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(-12px); }

/* Pomodoro */
.pomodoro-box {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--color-bg-card);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border);
}
.pomodoro-box--in-layout,
.widgets-column .pomodoro-box { position: static; width: 100%; height: auto; min-height: 240px; }
.widgets-column .pomodoro-box-header { cursor: default; }
.pomodoro-box-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-sm);
    font-size: var(--font-label);
    font-weight: 600;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    padding: var(--space-md) var(--space-lg);
    border-bottom: 1px solid var(--color-border);
}
.pomodoro-collapse { width: 24px; height: 24px; padding: 0; font-size: 1.1rem; line-height: 1; background: transparent; color: var(--color-text-placeholder); border: none; border-radius: var(--radius-sm); cursor: pointer; flex-shrink: 0; }
.pomodoro-collapse:hover { background: var(--color-border); color: var(--color-text); }
.pomodoro-tomato,
.pomodoro-timer-tab { display: none; font-size: var(--font-label); font-weight: 600; cursor: pointer; padding: 0.25rem 0.5rem; color: var(--color-text-muted); }
.pomodoro-box--collapsed .pomodoro-box-header { border-bottom: none; justify-content: center; padding: 0.5rem; cursor: pointer; }
.pomodoro-box--collapsed .pomodoro-box-title,
.pomodoro-box--collapsed .pomodoro-collapse { display: none; }
.pomodoro-box--collapsed .pomodoro-tomato,
.pomodoro-box--collapsed .pomodoro-timer-tab { display: block; }
.pomodoro-box--collapsed .pomodoro-box-body { display: none; }
.pomodoro-box-body { padding: var(--space-lg); }
.pomodoro-settings { display: flex; gap: var(--space-lg); margin-bottom: var(--space-md); }
.pomodoro-setting { display: flex; flex-direction: column; gap: var(--space-xs); }
.pomodoro-label { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); }
.pomodoro-setting input { width: 80px; padding: var(--space-sm); font-size: var(--font-body); border: 1px solid var(--color-border); border-radius: var(--radius-sm); background: var(--color-bg); color: var(--color-text); }
.pomodoro-display { margin-bottom: var(--space-md); }
.pomodoro-phase { font-size: var(--font-sm); color: var(--color-text-muted); display: block; }
.pomodoro-time { font-size: 1.5rem; font-weight: 600; color: var(--color-text); }
.pomodoro-controls { display: flex; gap: var(--space-sm); margin-bottom: var(--space-md); }
.pomodoro-btn { padding: var(--space-sm) var(--space-lg); font-size: var(--font-sm); border: none; border-radius: var(--radius-sm); cursor: pointer; background: var(--color-border); color: var(--color-text); }
.pomodoro-btn:hover { background: var(--color-border-strong); }
.pomodoro-sessions-row { display: flex; align-items: center; justify-content: space-between; gap: var(--space-sm); }
.pomodoro-sessions { font-size: var(--font-sm); color: var(--color-text-muted); }
#pomodoro-reset-sessions { padding: var(--space-xs) var(--space-sm); font-size: var(--font-xs); background: transparent; border: 1px solid var(--color-border); border-radius: var(--radius-sm); color: var(--color-text-muted); cursor: pointer; }
#pomodoro-reset-sessions:hover { color: var(--color-text); background: var(--color-border); }

/* Task panel */
.panel-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s ease, visibility 0.2s ease;
}
.panel-overlay[aria-hidden="false"] { opacity: 1; visibility: visible; }

.task-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: 380px;
    max-width: 100%;
    height: 100%;
    background: var(--color-bg-card);
    border-left: 1px solid var(--color-border);
    box-shadow: -4px 0 20px var(--color-shadow);
    z-index: 1001;
    overflow-y: auto;
    transform: translateX(100%);
    transition: transform 0.25s ease;
}
.task-panel[aria-hidden="false"] { transform: translateX(0); }

.panel-header { display: flex; justify-content: flex-end; padding: var(--space-md); border-bottom: 1px solid var(--color-border); }
.panel-close { width: 32px; height: 32px; padding: 0; font-size: 1.5rem; line-height: 1; background: transparent; border: none; color: var(--color-text-muted); cursor: pointer; border-radius: var(--radius-sm); }
.panel-close:hover { color: var(--color-text); background: var(--color-border); }
.panel-body { padding: var(--space-lg); }
.panel-label { font-size: var(--font-label); font-weight: 600; color: var(--color-text-muted); margin: 0 0 var(--space-xs) 0; display: block; }
.panel-title-input,
.panel-description-input,
.panel-due-input {
    width: 100%;
    padding: var(--input-padding-y) var(--input-padding-x);
    font-size: var(--font-body);
    font-family: inherit;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    color: var(--color-text);
    margin-bottom: var(--space-md);
}
.panel-description-input { min-height: 100px; resize: vertical; }
.panel-title-input:focus,
.panel-description-input:focus,
.panel-due-input:focus { outline: none; border-color: var(--color-border-focus); }

.panel-code-link-row { display: flex; align-items: center; gap: var(--space-sm); margin-top: var(--space-xs); margin-bottom: var(--space-md); }
.panel-code-link-input { flex: 1; min-width: 0; padding: var(--input-padding-y) var(--input-padding-x); font-size: var(--font-body); border: 1px solid var(--color-border); border-radius: var(--radius-sm); background: var(--color-bg); color: var(--color-text); }
.panel-code-link-input:focus { outline: none; border-color: var(--color-border-focus); }
.panel-open-link-btn { flex-shrink: 0; padding: var(--input-padding-y) var(--space-md); font-size: var(--font-sm); background: var(--color-border); color: var(--color-text); border: none; border-radius: var(--radius-sm); cursor: pointer; }
.panel-open-link-btn:hover { background: var(--color-border-strong); }

.panel-save {
    margin-top: var(--space-sm);
    margin-bottom: var(--space-lg);
    padding: var(--space-sm) var(--space-lg);
    font-size: var(--font-sm);
    font-family: inherit;
    background: var(--color-primary);
    color: #fff;
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
}
.panel-save:hover { background: var(--color-primary-hover); }
.panel-meta { display: flex; gap: var(--space-sm); align-items: center; margin-top: var(--space-md); }
.panel-status { font-size: var(--font-sm); color: var(--color-text-muted); text-transform: capitalize; }

[data-theme="dark"] .panel-overlay { background: rgba(0, 0, 0, 0.6); }
